//! # Request handlers module
//!
//! This module contains all the HTTP request handlers for the API endpoints.
//! Each submodule handles a specific type of resource.
//!
//! ## Submodules
//!
//! - `reviews`: Handlers for review-related operations
//! - `wplace`: Handlers for workplace screenshot management
//! - `books`: Handlers for book catalog operations
//! - `games`: Handlers for game collection management
//! - `projects`: Handlers for project portfolio
//! - `misc`: Miscellaneous handlers

pub mod books;
pub mod games;
pub mod misc;
pub mod projects;
pub mod reviews;
pub mod wplace;

#[rocket::get("/")]
pub fn index() -> &'static str {
    r#"
     ...     ..                                                                            ..       ..                                            
  .=*8888x <"?88h.                                                                   x .d88"  x .d88"    ..                                       
 X>  '8888H> '8888      .u    .          u.         .u    .                           5888R    5888R    @L                                        
'88h. `8888   8888    .d88B :@8c   ...ue888b      .d88B :@8c       .u          u      '888R    '888R   9888i   .dL                                
'8888 '8888    "88>  ="8888f8888r  888R Y888r    ="8888f8888r   ud8888.     us888u.    888R     888R   `Y888k:*888.                               
 `888 '8888.xH888x.    4888>'88"   888R I888>      4888>'88"  :888'8888. .@88 "8888"   888R     888R     888E  888I                               
   X" :88*~  `*8888>   4888> '     888R I888>      4888> '    d888 '88%" 9888  9888    888R     888R     888E  888I                               
 ~"   !"`      "888>   4888>       888R I888>      4888>      8888.+"    9888  9888    888R     888R     888E  888I                               
  .H8888h.      ?88   .d888L .+   u8888cJ888      .d888L .+   8888L      9888  9888    888R     888R     888E  888I                               
 :"^"88888h.    '!    ^"8888*"     "*888*P"       ^"8888*"    '8888c. .+ 9888  9888   .888B .  .888B .  x888N><888'                               
 ^    "88888hx.+"        "Y"         'Y"             "Y"       "88888%   "888*""888"  ^*888%   ^*888%    "88"  888                                
        ^"**""                                                   "YP'     ^Y"   ^Y'     "%       "%            88F                                
                                                                                                              98"                                 
                                                                                                            ./"                                   
                                                                                                           ~`                                     
     s                    .                  ..               s                                                                                   
    :8                   @88>              dF                :8                                                                                   
   .88       .u    .     %8P              '88bu.            .88           u.                         u.                                           
  :888ooo  .d88B :@8c     .         .u    '*88888bu        :888ooo  ...ue888b          uL      ...ue888b                                          
-*8888888 ="8888f8888r  .@88u    ud8888.    ^"*8888N     -*8888888  888R Y888r     .ue888Nc..  888R Y888r                                         
  8888      4888>'88"  ''888E` :888'8888.  beWE "888L      8888     888R I888>    d88E`"888E`  888R I888>                                         
  8888      4888> '      888E  d888 '88%"  888E  888E      8888     888R I888>    888E  888E   888R I888>                                         
  8888      4888>        888E  8888.+"     888E  888E      8888     888R I888>    888E  888E   888R I888>                                         
 .8888Lu=  .d888L .+     888E  8888L       888E  888F     .8888Lu= u8888cJ888     888E  888E  u8888cJ888                                          
 ^%888*    ^"8888*"      888&  '8888c. .+ .888N..888      ^%888*    "*888*P"      888& .888E   "*888*P"                                           
   'Y"        "Y"        R888"  "88888%    `"888*""         'Y"       'Y"         *888" 888&     'Y"                                              
                          ""      "YP'        ""                                   `"   "888E                                                     
                                                                                  .dWi   `88E                                                     
                                                                                  4888~  J8%                                                      
                                                                                   ^"===*"`                                                       
     s                        s                                 .                     ..                                                          
    :8                       :8      .uef^"                    @88>                 dF                                                            
   .88           u.         .88    :d88E                       %8P      u.    u.   '88bu.                    uL   ..                              
  :888ooo  ...ue888b       :888ooo `888E            .u          .     x@88k u@88c. '*88888bu        .u     .@88b  @88R                            
-*8888888  888R Y888r    -*8888888  888E .z8k    ud8888.      .@88u  ^"8888""8888"   ^"*8888N    ud8888.  '"Y888k/"*P                             
  8888     888R I888>      8888     888E~?888L :888'8888.    ''888E`   8888  888R   beWE "888L :888'8888.    Y888L                                
  8888     888R I888>      8888     888E  888E d888 '88%"      888E    8888  888R   888E  888E d888 '88%"     8888                                
  8888     888R I888>      8888     888E  888E 8888.+"         888E    8888  888R   888E  888E 8888.+"        `888N                               
 .8888Lu= u8888cJ888      .8888Lu=  888E  888E 8888L           888E    8888  888R   888E  888F 8888L       .u./"888&                              
 ^%888*    "*888*P"       ^%888*    888E  888E '8888c. .+      888&   "*88*" 8888" .888N..888  '8888c. .+ d888" Y888*"                            
   'Y"       'Y"            'Y"    m888N= 888>  "88888%        R888"    ""   'Y"    `"888*""    "88888%   ` "Y   Y"                               
                                    `Y"   888     "YP'          ""                     ""         "YP'                                            
                                         J88"                                                                                                     
                                         @%                                                                                                       
                                       :"                                                                                                         
                              s                                    ..                                ..                                  ..       
               oec :         :8      .uef^"                  . uW8"                            < .z@8"`                                dF         
       u.     @88888        .88    :d88E                     `t888                              !@88E                      u.    u.   '88bu.      
 ...ue888b    8"*88%       :888ooo `888E            .u        8888   .         u           .    '888E   u         .u     x@88k u@88c. '*88888bu   
 888R Y888r   8b.        -*8888888  888E .z8k    ud8888.      9888.z88N     us888u.   .udR88N    888E u@8NL    ud8888.  ^"8888""8888"   ^"*8888N  
 888R I888>  u888888>      8888     888E~?888L :888'8888.     9888  888E .@88 "8888" <888'888k   888E`"88*"  :888'8888.   8888  888R   beWE "888L 
 888R I888>   8888R        8888     888E  888E d888 '88%"     9888  888E 9888  9888  9888 'Y"    888E .dN.   d888 '88%"   8888  888R   888E  888E 
 888R I888>   8888P        8888     888E  888E 8888.+"        9888  888E 9888  9888  9888        888E~8888   8888.+"      8888  888R   888E  888E 
u8888cJ888    *888>       .8888Lu=  888E  888E 8888L          9888  888E 9888  9888  9888        888E '888&  8888L        8888  888R   888E  888F 
 "*888*P"     4888        ^%888*    888E  888E '8888c. .+    .8888  888" 9888  9888  ?8888u../   888E  9888. '8888c. .+  "*88*" 8888" .888N..888  
   'Y"        '888          'Y"    m888N= 888>  "88888%       `%888*%"   "888*""888"  "8888P'  '"888*" 4888"  "88888%      ""   'Y"    `"888*""   
               88R                  `Y"   888     "YP'           "`       ^Y"   ^Y'     "P'       ""    ""      "YP'                      ""      
               88>                       J88"                                                                                                     
               48                        @%                                                                                                       
               '8                      :"                                                                                                         
"#
}

#[rocket::catch(404)]
pub fn catch404() -> &'static str {
    r#"
 ________   ________  ________           _______      ___    ___ ___  ________  _________  _______   ________   _________        ________  ________  ___       ___          
|\   ___  \|\   __  \|\   ___  \        |\  ___ \    |\  \  /  /|\  \|\   ____\|\___   ___\\  ___ \ |\   ___  \|\___   ___\     |\   ____\|\   __  \|\  \     |\  \         
\ \  \\ \  \ \  \|\  \ \  \\ \  \       \ \   __/|   \ \  \/  / | \  \ \  \___|\|___ \  \_\ \   __/|\ \  \\ \  \|___ \  \_|     \ \  \___|\ \  \|\  \ \  \    \ \  \        
 \ \  \\ \  \ \  \\\  \ \  \\ \  \       \ \  \_|/__  \ \    / / \ \  \ \_____  \   \ \  \ \ \  \_|/_\ \  \\ \  \   \ \  \       \ \  \    \ \   __  \ \  \    \ \  \       
  \ \  \\ \  \ \  \\\  \ \  \\ \  \       \ \  \_|\ \  /     \/   \ \  \|____|\  \   \ \  \ \ \  \_|\ \ \  \\ \  \   \ \  \       \ \  \____\ \  \ \  \ \  \____\ \  \____  
   \ \__\\ \__\ \_______\ \__\\ \__\       \ \_______\/  /\   \    \ \__\____\_\  \   \ \__\ \ \_______\ \__\\ \__\   \ \__\       \ \_______\ \__\ \__\ \_______\ \_______\
    \|__| \|__|\|_______|\|__| \|__|        \|_______/__/ /\ __\    \|__|\_________\   \|__|  \|_______|\|__| \|__|    \|__|        \|_______|\|__|\|__|\|_______|\|_______|
                                                     |__|/ \|__|        \|_________|                                                                                        
                                                                                                                                                                            
                                                                                                                                                                            
 _____ ______   _______           _______      ___    ___ ___  ________  _________  _______   ________   _________  ___  ________  ___                                      
|\   _ \  _   \|\  ___ \         |\  ___ \    |\  \  /  /|\  \|\   ____\|\___   ___\\  ___ \ |\   ___  \|\___   ___\\  \|\   __  \|\  \                                     
\ \  \\\__\ \  \ \   __/|        \ \   __/|   \ \  \/  / | \  \ \  \___|\|___ \  \_\ \   __/|\ \  \\ \  \|___ \  \_\ \  \ \  \|\  \ \  \                                    
 \ \  \\|__| \  \ \  \_|/__       \ \  \_|/__  \ \    / / \ \  \ \_____  \   \ \  \ \ \  \_|/_\ \  \\ \  \   \ \  \ \ \  \ \   __  \ \  \                                   
  \ \  \    \ \  \ \  \_|\ \       \ \  \_|\ \  /     \/   \ \  \|____|\  \   \ \  \ \ \  \_|\ \ \  \\ \  \   \ \  \ \ \  \ \  \ \  \ \  \____                              
   \ \__\    \ \__\ \_______\       \ \_______\/  /\   \    \ \__\____\_\  \   \ \__\ \ \_______\ \__\\ \__\   \ \__\ \ \__\ \__\ \__\ \_______\                            
    \|__|     \|__|\|_______|        \|_______/__/ /\ __\    \|__|\_________\   \|__|  \|_______|\|__| \|__|    \|__|  \|__|\|__|\|__|\|_______|                            
                                              |__|/ \|__|        \|_________|                                                                                               
"#
}

#[rocket::catch(401)]
pub fn catch401() -> &'static str {
    r#"
   .-'''-.   ___    _     _______   .--.   .--.          ,---.    ,---.   ____     __          ______     .-./`)     _______   .--.   .--.   
  / _     \.'   |  | |   /   __  \  |  | _/  /           |    \  /    |   \   \   /  /        |    _ `''. \ .-.')   /   __  \  |  | _/  /    
 (`' )/`--'|   .'  | |  | ,_/  \__) | (`' ) /            |  ,  \/  ,  |    \  _. /  '         | _ | ) _  \/ `-' \  | ,_/  \__) | (`' ) /     
(_ o _).   .'  '_  | |,-./  )       |(_ ()_)             |  |\_   /|  |     _( )_ .'          |( ''_'  ) | `-'`"`,-./  )       |(_ ()_)      
 (_,_). '. '   ( \.-.|\  '_ '`)     | (_,_)   __         |  _( )_/ |  | ___(_ o _)'           | . (_) `. | .---. \  '_ '`)     | (_,_)   __  
.---.  \  :' (`. _` /| > (_)  )  __ |  |\ \  |  |        | (_ o _) |  ||   |(_,_)'            |(_    ._) ' |   |  > (_)  )  __ |  |\ \  |  | 
\    `-'  || (_ (_) _)(  .  .-'_/  )|  | \ `'   /        |  (_,_)  |  ||   `-'  /             |  (_.\.' /  |   | (  .  .-'_/  )|  | \ `'   / 
 \       /  \ /  . \ / `-'`-'     / |  |  \    /         |  |      |  | \      /              |       .'   |   |  `-'`-'     / |  |  \    /  
  `-...-'    ``-'`-''    `._____.'  `--'   `'-'          '--'      '--'  `-..-'               '-----'`     '---'    `._____.'  `--'   `'-'   "#
}

#[rocket::catch(500)]
pub fn catch500() -> &'static str {
    r#"
you lost the game.
    "#
}

#[cfg(test)]
mod tests {
    use super::*;
    use rocket::http::Status;
    use rocket::local::blocking::Client;

    #[test]
    fn test_index_route() {
        let rocket = rocket::build().mount("/", rocket::routes![index]);
        let client = Client::tracked(rocket).expect("valid rocket");

        let response = client.get("/").dispatch();
        assert_eq!(response.status(), Status::Ok);

        let body = response.into_string().unwrap();
        assert!(body.contains("8"));
    }
}
